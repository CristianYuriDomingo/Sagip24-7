<ion-header [translucent]="true">
  <ion-toolbar class="toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home" style="--color: #dc1212;"></ion-back-button>
    </ion-buttons>
    <div class="logo-container">
      <img src="assets/images/logo4.png" alt="Sagip 24/7 Logo" class="logo">
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" *ngIf="category">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{ category.title }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Custom Div Container -->
  <div class="custom-container">
    <!-- Image Background -->
    <div class="image-section">
      <img [src]="category.headerImage" alt="Background Image" />
    </div>

    <!-- Icon Overlay as Image -->
    <div class="overlay-icon">
      <img [src]="category.logoIcon" alt="Icon Image" />
    </div>

    <!-- Text Content -->
    <div class="text-section">
      <h2>{{ category.title }}</h2>
    </div>
  </div>

  <!-- Key Takeaways Section -->
  <div class="label-section">
    <h2>Key Takeaways</h2>
  </div>

  <!-- About Card -->
  <ion-card class="about-card">
    <ion-item lines="none">
      <!-- Left Icon -->
      <ion-avatar slot="start">
        <img src="assets/images/reading-book.png" alt="Icon" />
      </ion-avatar>

      <!-- Title -->
      <ion-label>
        <h2>{{ category.keyTakeawayTitle }}</h2>
        <p>{{ category.keyTakeawayDescription }}</p>
      </ion-label>
    </ion-item>
  </ion-card>

  <!-- First Aid Techniques Section -->
  <div class="label-section">
    <h2>First Aid Techniques</h2>
  </div>

  <!-- Dynamic Technique Cards -->
  <ion-card 
    *ngFor="let technique of category.techniques" 
    class="custom-card" 
    (click)="openTechniqueModal(technique)">
    <ion-item lines="none">
      <!-- Left Icon -->
      <ion-avatar slot="start">
        <img [src]="technique.icon" [alt]="technique.title + ' Icon'" />
      </ion-avatar>

      <!-- Title -->
      <ion-label>
        <h2>{{ technique.title }}</h2>
      </ion-label>

      <!-- Next Icon -->
      <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
    </ion-item>
  </ion-card>
</ion-content>

<!-- Dynamic Modal -->
<ion-modal [isOpen]="isModalOpen" (didDismiss)="closeModal()" *ngIf="selectedTechnique">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="closeModal()" style="--color: #dc1212;">Close</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <!-- Description Section -->
      <section class="description-section">
        <h3>{{ selectedTechnique.modalTitle }}</h3>
        <p>{{ selectedTechnique.description }}</p>
      </section>

      <hr class="section-divider">

      <!-- Dynamic Sliding Cards -->
      <div class="sliding-cards-container">
        <ion-card *ngFor="let step of selectedTechnique.steps" class="sliding-card">
          <ion-card-header>
            <ion-card-title>Step {{ step.stepNumber }}: {{ step.title }}</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <img [src]="step.image" [alt]="step.title" class="card-image" />
            <p>
              <li *ngFor="let desc of step.description">{{ desc }}</li>
            </p>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>