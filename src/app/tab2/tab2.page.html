<!-- src/app/tab2/tab2.page.html -->
<ion-header [translucent]="true">
  <ion-toolbar>
    <div class="header-wrapper">
      <div class="logo-container">
        <img src="assets/images/logo4.png" alt="Sagip 24/7 Logo" class="logo">
      </div>
      
      <!-- Language Switcher -->
      <div class="language-switcher">
        <ion-button fill="clear" (click)="presentLanguagePopover($event)" class="language-btn">
          <ion-icon name="globe-outline" slot="start"></ion-icon>
          <!-- Show full name on large screens, abbreviation on mobile -->
          <span class="lang-full">{{ currentLanguage === 'en' ? 'English' : 'Filipino' }}</span>
          <span class="lang-abbr">{{ currentLanguage === 'en' ? 'EN' : 'FIL' }}</span>
          <ion-icon name="chevron-down-outline" slot="end"></ion-icon>
        </ion-button>
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<!-- Rest of your content remains the same -->
<ion-content [fullscreen]="true" class="content">
  <!-- Lottie Animation Section -->
  <ion-card class="image-container-card">
    <div class="lottie-container">
      <ng-lottie 
        [options]="dashboardAnimationOptions"
        (animationCreated)="animationCreated($event)"
        class="lottie-animation">
      </ng-lottie>
    </div>
    <div class="overlay">
      <h2>We provide care, not judgement</h2>
      <p>With neutrality, independence, and compassion, we deliver life-saving first aid and support to those in need.
      </p>
    </div>
  </ion-card>

  <!-- Search Bar Section with Overlay Results -->
  <div class="search-wrapper">
    <div class="search-bar-container">
      <ion-searchbar 
        placeholder="Search for emergencies..." 
        mode="ios" 
        class="custom-searchbar"
        [(ngModel)]="searchQuery"
        (ionInput)="onSearchChange($event)"
        (ionFocus)="onSearchFocus()"
        (ionBlur)="onSearchBlur()">
      </ion-searchbar>
    </div>

    <!-- Overlay Backdrop (appears when searching) -->
    <div class="search-overlay-backdrop" 
         *ngIf="searchQuery.trim().length > 0 && isSearchFocused"
         (click)="clearSearch()">
    </div>

    <!-- Search Results Dropdown (overlays content) -->
    <div class="search-results-dropdown" 
         *ngIf="searchQuery.trim().length > 0 && isSearchFocused">
      <div class="search-results-wrapper">
        <!-- Show matching results as clickable chips -->
        <ion-chip 
          *ngFor="let suggestion of searchSuggestions"
          class="search-result-chip"
          [class.technique-chip]="suggestion.type === 'technique'"
          (click)="selectSuggestion(suggestion)">
          <ion-icon name="medical-outline"></ion-icon>
          <div class="chip-content">
            <ion-label>{{ suggestion.title }}</ion-label>
            <span *ngIf="suggestion.type === 'technique'" class="chip-badge">
              First Aid Technique
            </span>
          </div>
          <ion-icon name="chevron-forward-outline" class="forward-icon"></ion-icon>
        </ion-chip>

        <!-- No results message -->
        <div *ngIf="searchSuggestions.length === 0" class="no-results-message">
          <ion-icon name="search-outline"></ion-icon>
          <span>No emergencies found for "{{ searchQuery }}"</span>
        </div>
      </div>
    </div>
  </div>

  <ion-row>
    <ion-col size="2.4" class="icon-col">
      <ion-card class="icon-container-card" [routerLink]="['/visual-aids']">
        <img src="assets/images/icon2.png" alt="Visual Aids Icon" class="icon-image">
      </ion-card>
      <h3 class="icon-title">Visual<br>Aids</h3>
    </ion-col>

    <ion-col size="2.4" class="icon-col">
      <ion-card class="icon-container-card" [routerLink]="['/myths']">
        <img src="assets/images/icon4.png" alt="Emergency Response Icon" class="icon-image">
      </ion-card>
      <h3 class="icon-title">Myths vs<br>Facts</h3>
    </ion-col>

    <ion-col size="2.4" class="icon-col">
      <ion-card class="icon-container-card" [routerLink]="['/best-practices']">
        <img src="assets/images/icon5.png" alt="Best Practices Icon" class="icon-image">
      </ion-card>
      <h3 class="icon-title">Best<br>Practices</h3>
    </ion-col>

    <ion-col size="2.4" class="icon-col">
      <ion-card class="icon-container-card" [routerLink]="['/time-tracking']">
        <img src="assets/images/icon6.png" alt="Time Tracking Icon" class="icon-image">
      </ion-card>
      <h3 class="icon-title">Time<br>Tracking</h3>
    </ion-col>

    <ion-col size="2.4" class="icon-col">
      <ion-card class="icon-container-card" (click)="toggleFlashlight()">
        <img [src]="isFlashlightOn ? 'assets/images/icon-flashlight-on.png' : 'assets/images/icon-flashlight-off.png'"
          alt="Flashlight Icon" class="icon-image">
      </ion-card>
      <h3 class="icon-title">
        <span [class]="'flashlight-status ' + (isFlashlightOn ? 'on' : 'off')">
          {{ isFlashlightOn ? 'Turn Off' : 'Turn On' }}
        </span><br>
        Flashlight
      </h3>
    </ion-col>
  </ion-row>
  
  <div class="emergency-label">
    <h2>Types of Emergencies</h2>
  </div>

  <div class="card-container">
    <!-- Dynamic Emergency Cards -->
    <div *ngFor="let emergency of filteredEmergencies" [routerLink]="[emergency.route]" class="custom-card-wrapper">
      <ion-card class="custom-card">
        <div class="card-background" [style.background-image]="'url(' + emergency.backgroundImage + ')'">
          <div class="card-content">
            <h3 class="card-title">{{ emergency.title }}</h3>
          </div>
        </div>
        <img [src]="emergency.icon" class="card-icon" [alt]="emergency.title + ' Icon'">
      </ion-card>
    </div>

    <!-- No Results Message -->
    <div *ngIf="filteredEmergencies.length === 0 && searchQuery.trim().length > 0" style="width: 100%; text-align: center; padding: 40px 20px;">
      <p style="color: #999; font-size: 16px;">No emergencies found matching "{{ searchQuery }}"</p>
    </div>
  </div>
</ion-content>